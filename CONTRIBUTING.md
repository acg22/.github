# How to Build The Project

1. [Install Node.js](https://nodejs.org/en/download/)
2. ```shell
   corepack enable
   corepack yarn

   corepack yarn start
   # or
   corepack yarn build
   python3 -m http.server --bind localhost --directory dist
   ```

# Development Environment
I highly recommend using VSCode with the extensions listed in `.vscode/extensions.json` for development.
- `"slevesque.shader"` highlights `.frag`, `.vert` and `.glsl` files.
- `"bradlc.vscode-tailwindcss"` adds auto-completions and hovers to tailwind classes.
- `"ms-vscode.vscode-typescript-next"` allows us to use the `satisfies` syntax in TypeScript 4.9 before its release.

# Directory Structure
| Path | Purpose |
|-|-|
| public/ | The location of static assets. [Files in the `public/` directory are copied by Vite to the root directory.](https://vitejs.dev/guide/assets.html#the-public-directory) |
| public/audio | sound effects and bgms |
| public/font | fonts |
| public/models | 3D models. You can add 3D models you found online, but remember to update the `credit.html`, avoid using models that have ND licenses, and use smaller models (preferably under 5MB, 3MB â‰ˆ 1s to download). You can use this link: [sketchfab](https://sketchfab.com/search?features=downloadable&licenses=322a749bcfa841b29dff1e8a1bb74b0b&licenses=7c23a1ba438d4306920229c12afcb5f9&licenses=b9ddc40b93e34cdca1fc152f39b9f375&type=models) to search 3D models. |
| public/[audio,font,models]/credit.html | list of each file's attributions, updated by hand |
| public/lib_credit.html | the automatically updated list of third-party libraries |
| public/lib_credit2.html | the list of third-party libraries that are missing from lib_credit.html, updated by hand |
| src/main.ts | The entry point and the main game/render loop |
| src/debug.tsx | exports debugging components that should be removed in production builds. |
| src/saveData.ts | exports the centralized store of the game state. |
| src/hooks.ts | Defines events to be listened by various other modules. See the comment above the main game loop in `src/main.ts` to find when these events are fired. |
| src/dom/index.tsx | The entry point of the renderer of the UI. Supported browsers: The latest versions of desktop and mobile versions of Chrome (including all chromium-based browsers), Firefox, and Safari. |
| src/dom/ | Preact components |
| src/webgl/ | The directory to put modules related to webgl/Three.js. `index.ts` is automatically generated by looking up `export [default,const,class]` in `src/webgl/*.ts`. See also: [Using Shaders through Three.js](/docs/Using%20Shaders%20through%20Three.js.md)|
| src/weapons/ |  |
| src/stages/[id]_[name].ts | The definition of game stages. The filenames are parsed by a program to generate src/stages/index.ts. |
| src/constants.ts | defines constants you can tweak to balance the game, flavor text, etc. |
| codegen.js | This is the file that updates `src/[weapons,stages,webgl]/index.ts`, and it is run every time before building the project. |

# Cheating
The store in `saveData.ts` is set to a property of `window` so that you can modify its value from the [dev tools](https://developer.chrome.com/docs/devtools/open/) console.

```typescript
store.getState().addMoney(10000)
```

# Game Design
See `docs/flowchart.svg`
